{"remainingRequest":"/Users/xujunjie/Documents/git/projectComponent/node_modules/thread-loader/dist/cjs.js??ref--11-1!/Users/xujunjie/Documents/git/projectComponent/node_modules/docz-core/node_modules/babel-loader/lib/index.js??ref--11-2!/Users/xujunjie/Documents/git/projectComponent/node_modules/source-map-loader/index.js!/Users/xujunjie/Documents/git/projectComponent/src/CountUp/CountUp.tsx","dependencies":[{"path":"/Users/xujunjie/Documents/git/projectComponent/src/CountUp/CountUp.tsx","mtime":1594367130782},{"path":"/Users/xujunjie/Documents/git/projectComponent/node_modules/cache-loader/dist/cjs.js","mtime":1609062632110},{"path":"/Users/xujunjie/Documents/git/projectComponent/node_modules/thread-loader/dist/cjs.js","mtime":1609062632658},{"path":"/Users/xujunjie/Documents/git/projectComponent/node_modules/docz-core/node_modules/babel-loader/lib/index.js","mtime":1609062558293},{"path":"/Users/xujunjie/Documents/git/projectComponent/node_modules/source-map-loader/index.js","mtime":1609062632650}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9Vc2Vycy94dWp1bmppZS9Eb2N1bWVudHMvZ2l0L3Byb2plY3RDb21wb25lbnQvbm9kZV9tb2R1bGVzL2JhYmVsLXByZXNldC1yZWFjdC1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXkiOwoKdmFyIF90aGlzID0gdGhpcywKICAgIF9qc3hGaWxlTmFtZSA9ICIvVXNlcnMveHVqdW5qaWUvRG9jdW1lbnRzL2dpdC9wcm9qZWN0Q29tcG9uZW50L3NyYy9Db3VudFVwL0NvdW50VXAudHN4IjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGVudGVyTW9kdWxlID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmVudGVyTW9kdWxlIDogdW5kZWZpbmVkOwogIGVudGVyTW9kdWxlICYmIGVudGVyTW9kdWxlKG1vZHVsZSk7Cn0pKCk7Cgp2YXIgX19zaWduYXR1cmVfXyA9IHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbFsiZGVmYXVsdCJdLnNpZ25hdHVyZSA6IGZ1bmN0aW9uIChhKSB7CiAgcmV0dXJuIGE7Cn07CgppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7CmltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnOwppbXBvcnQgVGltZVNwYW4gZnJvbSAnLi4vY29yZS9UaW1lU3Bhbic7Cgp2YXIgY2xhc3NuYW1lcyA9IHJlcXVpcmUoJ2NsYXNzbmFtZXMnKTsKCi8qKgogKiDorqHml7blmagKICogQHBhcmFtIHByb3BzCiAqLwp2YXIgQ291bnRVcCA9IGZ1bmN0aW9uIENvdW50VXAocHJvcHMpIHsKICB2YXIgY291bnRVcENsYXNzTmFtZSA9IHByb3BzLmNvdW50VXBDbGFzc05hbWUsCiAgICAgIHN0YXJ0VGltZSA9IHByb3BzLnN0YXJ0VGltZSwKICAgICAgZm9ybWF0ID0gcHJvcHMuZm9ybWF0LAogICAgICBzZXJ2ZXJUaW1lc3RhbXAgPSBwcm9wcy5zZXJ2ZXJUaW1lc3RhbXA7CgogIHZhciBfdXNlU3RhdGUgPSB1c2VTdGF0ZShuZXcgVGltZVNwYW4oKSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICB0aW1lID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0VGltZSA9IF91c2VTdGF0ZTJbMV07CgogIHZhciBfdXNlU3RhdGUzID0gdXNlU3RhdGUoRGF0ZS5ub3coKSksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgc2VydlRpbWVDaGFuZ2VUaW1lID0gX3VzZVN0YXRlNFswXSwKICAgICAgc2V0U2VydlRpbWVDaGFuZ2VUaW1lID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIHVwZGF0ZVRpbWUgPSBmdW5jdGlvbiB1cGRhdGVUaW1lKCkgewogICAgdmFyIG5vdyA9IHNlcnZlclRpbWVzdGFtcCA/IHNlcnZlclRpbWVzdGFtcCArIChEYXRlLm5vdygpIC0gc2VydlRpbWVDaGFuZ2VUaW1lKSA6IERhdGUubm93KCk7CiAgICB2YXIgY291bnQgPSBub3cgLSBtb21lbnQoc3RhcnRUaW1lKS52YWx1ZU9mKCk7CiAgICBzZXRUaW1lKG5ldyBUaW1lU3BhbigwLCAwLCAwLCAwLCBjb3VudCkpOwogIH07CgogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICBjb25zb2xlLmxvZygnc2V0U2VydlRpbWVDaGFuZ2VUaW1lJyk7CiAgICBzZXRTZXJ2VGltZUNoYW5nZVRpbWUoRGF0ZS5ub3coKSk7CiAgfSwgW3NlcnZlclRpbWVzdGFtcF0pOwogIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7CiAgICB1cGRhdGVUaW1lKCk7CiAgICB2YXIgY291bnRVcCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgdXBkYXRlVGltZSgpOwogICAgfSwgMTAwMCk7CiAgICByZXR1cm4gZnVuY3Rpb24gY2xlYXIoKSB7CiAgICAgIGNsZWFySW50ZXJ2YWwoY291bnRVcCk7CiAgICB9OwogIH0sIFtzdGFydFRpbWVdKTsKICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgIGNsYXNzTmFtZTogY2xhc3NuYW1lcygnY291bnRVcENvbnRlbnQnLCBjb3VudFVwQ2xhc3NOYW1lKSwKICAgIF9fc2VsZjogX3RoaXMsCiAgICBfX3NvdXJjZTogewogICAgICBmaWxlTmFtZTogX2pzeEZpbGVOYW1lLAogICAgICBsaW5lTnVtYmVyOiA2NCwKICAgICAgY29sdW1uTnVtYmVyOiA1CiAgICB9CiAgfSwgdGltZS5mb3JtYXQoZm9ybWF0KSk7Cn07CgpfX3NpZ25hdHVyZV9fKENvdW50VXAsICJ1c2VTdGF0ZXtbdGltZSwgc2V0VGltZV0obmV3IFRpbWVTcGFuKCkpfVxudXNlU3RhdGV7W3NlcnZUaW1lQ2hhbmdlVGltZSwgc2V0U2VydlRpbWVDaGFuZ2VUaW1lXShEYXRlLm5vdygpKX1cbnVzZUVmZmVjdHt9XG51c2VFZmZlY3R7fSIpOwoKdmFyIF9kZWZhdWx0ID0gQ291bnRVcDsKZXhwb3J0IGRlZmF1bHQgX2RlZmF1bHQ7CgppZiAodHlwZW9mIENvdW50VXAgIT09ICd1bmRlZmluZWQnICYmIENvdW50VXAgJiYgQ291bnRVcCA9PT0gT2JqZWN0KENvdW50VXApICYmIE9iamVjdC5pc0V4dGVuc2libGUoQ291bnRVcCkpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ291bnRVcCwgJ19fZmlsZW1ldGEnLCB7CiAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgdmFsdWU6IHsKICAgICAgbmFtZTogIkNvdW50VXAiLAogICAgICBmaWxlbmFtZTogInNyYy9Db3VudFVwL0NvdW50VXAudHN4IgogICAgfQogIH0pOwp9Cgo7CgooZnVuY3Rpb24gKCkgewogIHZhciByZWFjdEhvdExvYWRlciA9IHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbC5kZWZhdWx0IDogdW5kZWZpbmVkOwoKICBpZiAoIXJlYWN0SG90TG9hZGVyKSB7CiAgICByZXR1cm47CiAgfQoKICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihDb3VudFVwLCAiQ291bnRVcCIsICIvVXNlcnMveHVqdW5qaWUvRG9jdW1lbnRzL2dpdC9wcm9qZWN0Q29tcG9uZW50L3NyYy9Db3VudFVwL0NvdW50VXAudHN4Iik7CiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoX2RlZmF1bHQsICJkZWZhdWx0IiwgIi9Vc2Vycy94dWp1bmppZS9Eb2N1bWVudHMvZ2l0L3Byb2plY3RDb21wb25lbnQvc3JjL0NvdW50VXAvQ291bnRVcC50c3giKTsKfSkoKTsKCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGxlYXZlTW9kdWxlID0gdHlwZW9mIHJlYWN0SG90TG9hZGVyR2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IHJlYWN0SG90TG9hZGVyR2xvYmFsLmxlYXZlTW9kdWxlIDogdW5kZWZpbmVkOwogIGxlYXZlTW9kdWxlICYmIGxlYXZlTW9kdWxlKG1vZHVsZSk7Cn0pKCk7"},{"version":3,"sources":["/Users/xujunjie/Documents/git/projectComponent/src/CountUp/CountUp.tsx"],"names":["moment","React","useEffect","useState","TimeSpan","classnames","require","CountUp","props","countUpClassName","startTime","format","serverTimestamp","time","setTime","Date","now","servTimeChangeTime","setServTimeChangeTime","updateTime","count","valueOf","console","log","countUp","setInterval","clear","clearInterval"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,QAAP,MAAqB,kBAArB;;AAEA,IAAMC,UAAU,GAAGC,OAAO,CAAC,YAAD,CAA1B;;AA2BA;AACA;AACA;AACA;AACA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,KAAD,EAA0B;AAAA,MAChCC,gBADgC,GACyBD,KADzB,CAChCC,gBADgC;AAAA,MACdC,SADc,GACyBF,KADzB,CACdE,SADc;AAAA,MACHC,MADG,GACyBH,KADzB,CACHG,MADG;AAAA,MACKC,eADL,GACyBJ,KADzB,CACKI,eADL;;AAAA,kBAGhBT,QAAQ,CAAC,IAAIC,QAAJ,EAAD,CAHQ;AAAA;AAAA,MAGjCS,IAHiC;AAAA,MAG3BC,OAH2B;;AAAA,mBAIYX,QAAQ,CAACY,IAAI,CAACC,GAAL,EAAD,CAJpB;AAAA;AAAA,MAIjCC,kBAJiC;AAAA,MAIbC,qBAJa;;AAMxC,MAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,QAAMH,GAAG,GAAGJ,eAAe,GAAGA,eAAe,IAAIG,IAAI,CAACC,GAAL,KAAaC,kBAAjB,CAAlB,GAAyDF,IAAI,CAACC,GAAL,EAApF;AACA,QAAMI,KAAK,GAAGJ,GAAG,GAAGhB,MAAM,CAACU,SAAD,CAAN,CAAkBW,OAAlB,EAApB;AACAP,IAAAA,OAAO,CAAC,IAAIV,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,EAAyBgB,KAAzB,CAAD,CAAP;AACD,GAJD;;AAMAlB,EAAAA,SAAS,CAAC,YAAM;AACdoB,IAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACAL,IAAAA,qBAAqB,CAACH,IAAI,CAACC,GAAL,EAAD,CAArB;AACD,GAHQ,EAGN,CAACJ,eAAD,CAHM,CAAT;AAKAV,EAAAA,SAAS,CAAC,YAAM;AACdiB,IAAAA,UAAU;AACV,QAAMK,OAAO,GAAGC,WAAW,CAAC,YAAM;AAChCN,MAAAA,UAAU;AACX,KAF0B,EAExB,IAFwB,CAA3B;AAGA,WAAO,SAASO,KAAT,GAAiB;AACtBC,MAAAA,aAAa,CAACH,OAAD,CAAb;AACD,KAFD;AAGD,GARQ,EAQN,CAACd,SAAD,CARM,CAAT;AAUA,sBACE;AAAK,IAAA,SAAS,EAAEL,UAAU,CAAC,gBAAD,EAAmBI,gBAAnB,CAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAiEI,IAAI,CAACF,MAAL,CAAYA,MAAZ,CAAjE,CADF;AAGD,CA9BD;;cAAMJ,O;;eAgCSA,O;AAAf;;;;;;;;;;;;;;;;;;;;;;0BAhCMA,O","sourcesContent":["import moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport TimeSpan from '../core/TimeSpan';\n\nconst classnames = require('classnames');\n\ninterface ICountUpProps {\n  /**\n   * 服务器时间戳，如果不传，以客户端时间为准\n   */\n  serverTimestamp?: number;\n\n  /**\n   * 计时开始时间\n   */\n  startTime: string;\n\n  /**\n   * 显示时间的格式，最大只能格式化到天\n   * dd 表示天  hh 表示小时  mm表示分钟  ss表示秒\n   * HH可超过60小时  MM和SS同理\n   * 如 25小时20分钟10秒  可用HH:mm:ss表示为25:20:10  也可用dd hh:mm:ss 表示为01 01:20:10\n   */\n  format?: string;\n\n  /**\n   * 计时器显示的样式类名\n   */\n  countUpClassName?: string;\n}\n\n/**\n * 计时器\n * @param props\n */\nconst CountUp = (props: ICountUpProps) => {\n  const { countUpClassName, startTime, format, serverTimestamp } = props;\n\n  const [time, setTime] = useState(new TimeSpan());\n  const [servTimeChangeTime, setServTimeChangeTime] = useState(Date.now());\n\n  const updateTime = () => {\n    const now = serverTimestamp ? serverTimestamp + (Date.now() - servTimeChangeTime) : Date.now();\n    const count = now - moment(startTime).valueOf();\n    setTime(new TimeSpan(0, 0, 0, 0, count));\n  };\n\n  useEffect(() => {\n    console.log('setServTimeChangeTime');\n    setServTimeChangeTime(Date.now());\n  }, [serverTimestamp]);\n\n  useEffect(() => {\n    updateTime();\n    const countUp = setInterval(() => {\n      updateTime();\n    }, 1000);\n    return function clear() {\n      clearInterval(countUp);\n    };\n  }, [startTime]);\n\n  return (\n    <div className={classnames('countUpContent', countUpClassName)}>{time.format(format)}</div>\n  );\n};\n\nexport default CountUp;\n"]}]}